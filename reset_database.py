from app import create_app, db
from app.models import User, Habit
import os

app = create_app()


def reset_database():
    with app.app_context():
        # –£–¥–∞–ª—è–µ–º –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
        print("üóëÔ∏è –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Ç–∞–±–ª–∏—Ü—ã...")
        db.drop_all()

        # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã –∑–∞–Ω–æ–≤–æ
        print("üîÑ –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã...")
        db.create_all()

        # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        print("üë§ –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...")
        user = User(username='test', email='test@example.com')
        user.set_password('test')
        db.session.add(user)
        db.session.commit()

        # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–≤—ã—á–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        habits_data = [
            ("–†–µ–≥—É–ª—è—Ä–Ω—ã–π —Å–æ–Ω", "–õ–æ–∂–∏—Ç—å—Å—è –∏ –≤—Å—Ç–∞–≤–∞—Ç—å –≤ –æ–¥–Ω–æ –≤—Ä–µ–º—è –¥–∞–∂–µ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ"),
            ("–í–æ–¥–∞ —Å —É—Ç—Ä–∞", "–í—ã–ø–∏—Ç—å —Å—Ç–∞–∫–∞–Ω –≤–æ–¥—ã —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è"),
            ("–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ", "30 –º–∏–Ω—É—Ç —Ö–æ–¥—å–±—ã, –∑–∞—Ä—è–¥–∫–∏ –∏–ª–∏ —Ä–∞—Å—Ç—è–∂–∫–∏"),
            ("–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–Ω—è", "–°–æ—Å—Ç–∞–≤–∏—Ç—å –ø–ª–∞–Ω –Ω–∞ –¥–µ–Ω—å —É—Ç—Ä–æ–º"),
            ("–ò–∑—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ", "15-20 –º–∏–Ω—É—Ç –≤ –¥–µ–Ω—å –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ —á–µ–≥–æ-—Ç–æ –Ω–æ–≤–æ–≥–æ"),
            ("–í–µ—á–µ—Ä–Ω–∏–π —Ä–∏—Ç—É–∞–ª", "10 –º–∏–Ω—É—Ç –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –¥–Ω—é")
        ]

        for name, description in habits_data:
            habit = Habit(name=name, description=description, user_id=user.id)
            db.session.add(habit)

        db.session.commit()
        print(f"‚úÖ –°–æ–∑–¥–∞–Ω–æ {len(habits_data)} –ø—Ä–∏–≤—ã—á–µ–∫ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user.username}")


if __name__ == '__main__':
    reset_database()